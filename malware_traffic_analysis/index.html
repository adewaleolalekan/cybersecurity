<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Capstone Project: Malware Traffic Analysis</title>
    
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Custom Styles -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -1px;
            top: 1rem;
            bottom: -1rem;
            width: 2px;
            background-color: #4b5563; /* gray-600 */
        }
        .timeline-item:last-child::before {
            display: none;
        }
        .timeline-dot {
            position: absolute;
            left: -9px;
            top: 0.8rem;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background-color: #ef4444; /* red-500 */
            border: 4px solid #1f2937; /* gray-800 */
        }
        .code-block {
            background-color: #1f2937;
            border-radius: 0.5rem;
            padding: 1rem;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.875rem;
            white-space: pre-wrap;
            word-break: break-all;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-300 antialiased">

    <!-- Main Container -->
    <div class="container mx-auto max-w-5xl px-4 sm:px-6 lg:px-8 py-12 sm:py-16">

        <!-- Header -->
        <header class="text-center mb-16">
            <h1 class="text-4xl sm:text-5xl font-bold text-white tracking-tight">Incident Report: Malware Traffic Analysis</h1>
            <p class="mt-4 text-lg text-cyan-400">Capstone Project on bluemoontuesday[.]com Network</p>
        </header>

        <!-- Main Content Grid -->
        <main class="space-y-12">

            <!-- Executive Summary -->
            <section class="bg-gray-800 p-6 sm:p-8 rounded-xl shadow-lg">
                <h2 class="text-2xl font-semibold text-white border-b-2 border-cyan-500 pb-3 mb-6">1. Executive Summary</h2>
                <p>On July 12, 2025, a malware infection was detected on host <code class="bg-gray-700 px-2 py-1 rounded">10.1.17.215</code>. The infection was triggered by a suspicious ZIP file downloaded by an employee attempting to install "Google Authenticator for Windows." Analysis of network traffic using Wireshark confirmed connections to known malicious infrastructure, including direct IP-based file downloads and Command and Control (C2) beaconing. This report details the incident timeline, key findings, and recommendations for mitigation.</p>
            </section>

            <!-- Timeline of Events -->
            <section class="bg-gray-800 p-6 sm:p-8 rounded-xl shadow-lg">
                <h2 class="text-2xl font-semibold text-white border-b-2 border-cyan-500 pb-3 mb-6">2. Timeline of Events</h2>
                <div class="relative pl-4">
                    <div class="timeline-item relative pb-8">
                        <div class="timeline-dot"></div>
                        <h4 class="font-semibold text-white">38.86s: DNS Query</h4>
                        <p class="text-sm">Infected host (<code class="text-cyan-400">10.1.17.215</code>) queries for <code class="text-cyan-400">authenticatoor.org</code>.</p>
                    </div>
                    <div class="timeline-item relative pb-8">
                        <div class="timeline-dot"></div>
                        <h4 class="font-semibold text-white">60.30s: Initial Infection</h4>
                        <p class="text-sm">Host makes an HTTP GET request to C2 server <code class="text-cyan-400">5.252.153.241</code> to download the first payload.</p>
                    </div>
                    <div class="timeline-item relative pb-8">
                        <div class="timeline-dot"></div>
                        <h4 class="font-semibold text-white">62.15s: PowerShell Payload</h4>
                        <p class="text-sm">A second payload, a PowerShell script (<code class="text-cyan-400">29842.ps1</code>), is downloaded from the same C2 server.</p>
                    </div>
                    <div class="timeline-item relative pb-8">
                        <div class="timeline-dot"></div>
                        <h4 class="font-semibold text-white">62.37s: C2 Beaconing Begins</h4>
                        <p class="text-sm">The first C2 beacon is sent to <code class="text-cyan-400">5.252.153.241</code>. This continues at ~5-second intervals.</p>
                    </div>
                    <div class="timeline-item relative pb-8">
                        <div class="timeline-dot"></div>
                        <h4 class="font-semibold text-white">124.99s: Persistence Payload</h4>
                        <p class="text-sm">Malware downloads TeamViewer from the C2 server for remote access persistence.</p>
                    </div>
                    <div class="timeline-item relative">
                        <div class="timeline-dot"></div>
                        <h4 class="font-semibold text-white">611.24s: Secondary C2 Channel</h4>
                        <p class="text-sm">Host communicates with a secondary C2 server (<code class="text-cyan-400">185.188.32.26</code>) using a client identified as <code class="text-cyan-400">DynGate</code>, a known RAT.</p>
                    </div>
                </div>
            </section>

             <!-- Analysis Walkthrough -->
            <section class="bg-gray-800 p-6 sm:p-8 rounded-xl shadow-lg">
                <h2 class="text-2xl font-semibold text-white border-b-2 border-cyan-500 pb-3 mb-6">3. Analysis Walkthrough</h2>
                <p class="mb-4">The investigation began by analyzing the provided Wireshark PCAP file. By correlating events across different protocols, the full infection chain was reconstructed.</p>
                <ul class="space-y-2 text-sm">
                    <li><strong>1. DNS Analysis:</strong> Reviewed DNS logs to identify the infected client's hostname (<code class="text-cyan-400">DESKTOP-L8C5GSJ</code>) and the initial malicious domain query.</li>
                    <li><strong>2. HTTP Analysis:</strong> Filtered for HTTP traffic from the infected host. This revealed the initial payload download, subsequent script retrievals, and the C2 beaconing pattern.</li>
                    <li><strong>3. TCP Stream Analysis:</strong> Confirmed the establishment of connections to malicious IP addresses on port 80 (HTTP), corroborating the HTTP analysis.</li>
                </ul>
            </section>

            <!-- Host & C2 Details -->
            <section class="bg-gray-800 p-6 sm:p-8 rounded-xl shadow-lg">
                <h2 class="text-2xl font-semibold text-white border-b-2 border-cyan-500 pb-3 mb-6">4. Host and C2 Details</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="font-semibold text-lg text-white mb-2"><i class="fas fa-desktop mr-2 text-cyan-400"></i>Infected Host Details</h3>
                        <ul class="space-y-1 text-sm">
                            <li><strong>IP Address:</strong> <code class="bg-gray-700 px-2 py-1 rounded">10.1.17.215</code></li>
                            <li><strong>MAC Address:</strong> <code class="bg-gray-700 px-2 py-1 rounded">00:d0:b7:26:4a:74</code></li>
                            <li><strong>Hostname:</strong> <code class="bg-gray-700 px-2 py-1 rounded">DESKTOP-L8C5GSJ</code></li>
                            <li><strong>User Account:</strong> <code class="bg-gray-700 px-2 py-1 rounded">shutchenson</code></li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="font-semibold text-lg text-white mb-2"><i class="fas fa-server mr-2 text-red-400"></i>Command & Control Servers</h3>
                         <ul class="space-y-1 text-sm">
                            <li><strong>Primary C2 (Payloads/Beaconing):</strong> <code class="bg-gray-700 px-2 py-1 rounded">5.252.153.241</code></li>
                            <li><strong>Secondary C2 (DynGate RAT):</strong> <code class="bg-gray-700 px-2 py-1 rounded">185.188.32.26</code></li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Wireshark Evidence -->
            <section class="bg-gray-800 p-6 sm:p-8 rounded-xl shadow-lg">
                <h2 class="text-2xl font-semibold text-white border-b-2 border-cyan-500 pb-3 mb-6">5. Wireshark Evidence</h2>
                <p class="mb-6">The following screenshots from Wireshark provide direct evidence of the malicious activity.</p>
                <div class="space-y-8">
                    <div>
                        <h3 class="font-semibold text-lg text-white mb-2">Screenshot 1: HTTP Filter Showing Malicious Downloads & C2 Beacons</h3>
                        <img src="GET.png" alt="Wireshark HTTP Filter" class="rounded-lg shadow-lg" onerror="this.onerror=null;this.src='https://placehold.co/1200x400/1f2937/9ca3af?text=Image+Not+Found';">
                        <p class="text-sm text-gray-400 mt-2">This view, filtered for HTTP requests from the infected host, clearly shows the sequence of GET requests for malicious payloads and the repetitive C2 beaconing.</p>
                    </div>
                    <div>
                        <h3 class="font-semibold text-lg text-white mb-2">Screenshot 2: Packet Details of a C2 Beacon</h3>
                        <img src="detail.png" alt="Wireshark Packet Details" class="rounded-lg shadow-lg" onerror="this.onerror=null;this.src='https://placehold.co/1200x400/1f2937/9ca3af?text=Image+Not+Found';">
                        <p class="text-sm text-gray-400 mt-2">A detailed look at one of the C2 beacon packets, showing the GET request to the unique URI <code class="bg-gray-700 px-1 rounded">/1517096937</code> and the server's <code class="bg-gray-700 px-1 rounded">404 Not Found</code> response, which is typical for this type of C2 communication.</p>
                    </div>
                </div>
            </section>

            <!-- IOC Table -->
            <section class="bg-gray-800 p-6 sm:p-8 rounded-xl shadow-lg">
                <h2 class="text-2xl font-semibold text-white border-b-2 border-cyan-500 pb-3 mb-6">6. Indicators of Compromise (IOCs)</h2>
                <div class="overflow-x-auto">
                    <table class="w-full text-left border-collapse">
                        <thead class="bg-gray-700 text-white">
                            <tr>
                                <th class="p-3 text-sm font-semibold tracking-wide">IOC Type</th>
                                <th class="p-3 text-sm font-semibold tracking-wide">Value</th>
                                <th class="p-3 text-sm font-semibold tracking-wide">Context</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-600">
                            <tr class="hover:bg-gray-700/50">
                                <td class="p-3 font-semibold">IP Address</td>
                                <td class="p-3 font-mono">5.252.153.241</td>
                                <td class="p-3">Primary C2 Server (Payloads & Beaconing)</td>
                            </tr>
                            <tr class="hover:bg-gray-700/50">
                                <td class="p-3 font-semibold">IP Address</td>
                                <td class="p-3 font-mono">185.188.32.26</td>
                                <td class="p-3">Secondary C2 Server (DynGate RAT)</td>
                            </tr>
                            <tr class="hover:bg-gray-700/50">
                                <td class="p-3 font-semibold">URL</td>
                                <td class="p-3 font-mono text-xs">hxxp://5.252.153[.]241/api/file/get-file/264872</td>
                                <td class="p-3">Initial payload download</td>
                            </tr>
                             <tr class="hover:bg-gray-700/50">
                                <td class="p-3 font-semibold">URL Path</td>
                                <td class="p-3 font-mono">/1517096937</td>
                                <td class="p-3">C2 Beaconing URI</td>
                            </tr>
                            <tr class="hover:bg-gray-700/50">
                                <td class="p-3 font-semibold">User-Agent</td>
                                <td class="p-3 font-mono">DynGate</td>
                                <td class="p-3">RAT identifier for C2 communication</td>
                            </tr>
                             <tr class="hover:bg-gray-700/50">
                                <td class="p-3 font-semibold">File Hash (SHA256)</td>
                                <td class="p-3 font-mono text-xs">4bed34b1cd5663a5a857b3bbf81cc5413c61cb561e9a90067b57da08b01ae70b</td>
                                <td class="p-3">SHA256 of application_setup.js</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Recommendations -->
            <section class="bg-cyan-900/50 border border-cyan-700 p-6 sm:p-8 rounded-xl shadow-lg">
                <h2 class="text-2xl font-semibold text-white border-b-2 border-cyan-500 pb-3 mb-6">7. Recommendations for Mitigation</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-6 text-sm">
                    <div class="bg-gray-800 p-4 rounded-lg">
                        <h3 class="font-semibold text-red-400 mb-2">Immediate Actions</h3>
                        <ul class="list-disc list-inside space-y-1">
                            <li>Isolate the infected host.</li>
                            <li>Block all IOCs at the firewall.</li>
                            <li>Reset the user's credentials.</li>
                        </ul>
                    </div>
                    <div class="bg-gray-800 p-4 rounded-lg">
                        <h3 class="font-semibold text-orange-400 mb-2">Intermediate Actions</h3>
                        <ul class="list-disc list-inside space-y-1">
                            <li>Create a forensic image of the host.</li>
                            <li>Review network logs for other compromised hosts.</li>
                            <li>Re-image the machine from a trusted source.</li>
                        </ul>
                    </div>
                    <div class="bg-gray-800 p-4 rounded-lg">
                        <h3 class="font-semibold text-green-400 mb-2">Long-Term Actions</h3>
                        <ul class="list-disc list-inside space-y-1">
                            <li>Enhance web filtering.</li>
                            <li>Conduct user security awareness training.</li>
                            <li>Deploy an EDR solution.</li>
                        </ul>
                    </div>
                </div>
            </section>

        </main>

        <!-- Footer -->
        <footer class="text-center mt-16 text-gray-500">
            <p>&copy; 2025 Adewale Olalekan - A Personal Cybersecurity Project</p>
        </footer>

    </div>

</body>
</html>
